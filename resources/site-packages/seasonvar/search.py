# coding: utf-8
# vim:fenc=utf-8:sts=0:ts=4:sw=4:et:tw=80

#
# Copyright Â© 2016 gr4ph3 <giraffeoncode@gmail.com>
#
# Distributed under terms of the MIT license.
#
from __future__ import unicode_literals
from seasonvar.requester import Requester
try:
    # for python 2.7
    from urllib import urlencode
except ImportError:
    # for python 3.x
    from urllib.parse import urlencode


SEARCHURL = 'http://seasonvar.ru/autocomplete.php'


def items(term):
    requester = Requester()
    params = urlencode({'query': term.encode('utf8')})
    url = '{0}?{1}'.format(SEARCHURL, params)
    ret = requester.get_json(url)
    print(ret)
    for sname, surl in zip(ret['suggestions'],
                           ret['data']):
        resurl = '/' + surl if surl else None
        yield {
            'name': sname,
            'url': resurl
        }
