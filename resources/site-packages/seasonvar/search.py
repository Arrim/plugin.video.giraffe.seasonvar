# coding: utf-8

#
# Copyright Â© 2016 gr4ph3 <giraffeoncode@gmail.com>
#
# Distributed under terms of the MIT license.
#
from __future__ import unicode_literals
from seasonvar import Requester
try:  # for python 2.7
    from urllib import quote
except ImportError:  # for python 3.x
    from urllib.parse import quote


def response_items(search_response):
    for name, url in zip(search_response['suggestions'],
                         search_response['data']):
        if url:
            yield {'name': name, 'url': '/' + url}


def searchitems(term):
    term = quote(term.encode('utf-8'))
    params = 'query={0}'.format(term)
    url = '{0}?{1}'.format('http://seasonvar.ru/autocomplete.php', params)
    requester = Requester()
    # in python > 3.3.0 it is just:
    #
    #   yield from response_items(requester.get_json(url))
    #
    # but kodi use old python
    for item in response_items(requester.get_json(url)):
        yield item
