# coding: utf-8
# vim:fenc=utf-8:sts=0:ts=4:sw=4:et:tw=80

#
# Copyright Â© 2016 gr4ph3 <giraffeoncode@gmail.com>
#
# Distributed under terms of the MIT license.
#
from seasonvar.requester import Requester
try:
    # for python 2.7
    from urllib import quote
except ImportError:
    # for python 3.x
    from urllib.parse import quote


SEARCHURL = 'http://seasonvar.ru/autocomplete.php'


def items(term):
    term = quote(term)
    params = 'query={0}'.format(term)
    url = '{0}?{1}'.format(SEARCHURL, params)
    requester = Requester()
    ret = requester.get_json(url)
    for sname, surl in zip(ret['suggestions'],
                           ret['data']):
        resurl = '/' + surl if surl else None
        yield {
            'name': sname,
            'url': resurl
        }
